<!-- templates/core/partials/notification_dropdown.html -->
{% if notifications %}
    {% for notification in notifications %}
    <div class="px-4 py-3 hover:bg-gray-50 border-b border-gray-100">
        <div class="flex items-start">
            <div class="flex-shrink-0">
                {% if notification.notification_type == 'success' %}
                    <i class="fas fa-check-circle text-green-500"></i>
                {% elif notification.notification_type == 'warning' %}
                    <i class="fas fa-exclamation-triangle text-yellow-500"></i>
                {% elif notification.notification_type == 'error' %}
                    <i class="fas fa-exclamation-circle text-red-500"></i>
                {% elif notification.notification_type == 'product_update' %}
                    <i class="fas fa-box text-blue-500"></i>
                {% elif notification.notification_type == 'price_change' %}
                    <i class="fas fa-dollar-sign text-purple-500"></i>
                {% elif notification.notification_type == 'new_asset' %}
                    <i class="fas fa-file text-indigo-500"></i>
                {% elif notification.notification_type == 'feed_ready' %}
                    <i class="fas fa-download text-green-500"></i>
                {% else %}
                    <i class="fas fa-info-circle text-blue-500"></i>
                {% endif %}
            </div>
            <div class="ml-3 flex-1">
                <p class="text-sm font-medium text-gray-900">
                    {{ notification.title }}
                </p>
                <p class="text-xs text-gray-500 mt-1">
                    {{ notification.message|truncatewords:15 }}
                </p>
                <p class="text-xs text-gray-400 mt-1">
                    {{ notification.created_at|timesince }} ago
                </p>
                {% if notification.action_url %}
                <a href="{{ notification.action_url }}"
                   class="text-xs text-blue-600 hover:text-blue-800 mt-1 inline-block">
                    {{ notification.action_label|default:"View" }} â†’
                </a>
                {% endif %}
            </div>
            <button hx-post="{% url 'core:mark_notification_read' notification.id %}"
                    hx-target="#notification-dropdown"
                    hx-swap="outerHTML"
                    class="ml-2 text-gray-400 hover:text-gray-600">
                <i class="fas fa-times text-xs"></i>
            </button>
        </div>
    </div>
    {% endfor %}

    <div class="px-4 py-3 bg-gray-50">
        <div class="flex items-center justify-between">
            <a href="{% url 'core:notification_list' %}"
               class="text-sm text-blue-600 hover:text-blue-800">
                View all notifications
            </a>
            {% if unread_count > 5 %}
            <span class="text-xs text-gray-500">
                {{ unread_count|add:"-5" }} more unread
            </span>
            {% endif %}
        </div>
    </div>
{% else %}
    <div class="px-4 py-8 text-center">
        <i class="fas fa-bell-slash text-gray-300 text-3xl mb-2"></i>
        <p class="text-sm text-gray-500">No new notifications</p>
    </div>
{% endif %}